{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\Admin\\\\Desktop\\\\WhatsApp\\\\whatsapp-clone\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React from'react';import'./Chat.css';import{Avatar,IconButton,Button}from\"@material-ui/core\";import{useEffect,useState}from\"react\";import SearchOutlined from\"@material-ui/icons/SearchOutlined\";import AttachFile from\"@material-ui/icons/AttachFile\";import MoreVert from\"@material-ui/icons/MoreVert\";import InsertEmoticonIcon from'@material-ui/icons/InsertEmoticon';import MicIcon from'@material-ui/icons/Mic';import SendIcon from'@material-ui/icons/Send';import{useParams}from\"react-router-dom\";import db from'./firebase';import{useStateValue}from'./StateProvider';import firebase from'firebase';function Chat(){var _messages,_messages$timestamp;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),input=_useState2[0],setInput=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),seed=_useState4[0],setSeed=_useState4[1];var _useParams=useParams(),roomId=_useParams.roomId;var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),roomName=_useState6[0],setRoomName=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),messages=_useState8[0],setMessages=_useState8[1];var _useStateValue=useStateValue(),_useStateValue2=_slicedToArray(_useStateValue,2),user=_useStateValue2[0].user,dispatch=_useStateValue2[1];useEffect(function(){if(roomId){db.collection('rooms').doc(roomId).onSnapshot(function(snapshot){return setRoomName(snapshot.data().name);});db.collection('rooms').doc(roomId).collection('messages').orderBy('timestamp',\"asc\").onSnapshot(function(snapshot){return setMessages(snapshot.docs.map(function(doc){return doc.data();}));});}},[roomId]);useEffect(function(){setSeed(Math.floor(Math.random()*5000));},[roomId]);var sendMessage=function sendMessage(e){e.preventDefault();console.log(\"You Typed >>>>\",input);db.collection('rooms').doc(roomId).collection(\"messages\").add({message:input,name:user.displayName,timestamp:firebase.firestore.FieldValue.serverTimestamp()});setInput(\"\");};return/*#__PURE__*/React.createElement(\"div\",{className:\"chat\"},/*#__PURE__*/React.createElement(\"div\",{className:\"chat__header\"},/*#__PURE__*/React.createElement(Avatar,{src:\"https://avatars.dicebear.com/api/human/\".concat(seed,\".svg\")}),/*#__PURE__*/React.createElement(\"div\",{className:\"chat__headerInfo\"},/*#__PURE__*/React.createElement(\"h3\",null,roomName),/*#__PURE__*/React.createElement(\"p\",null,\"last seen\",\" \",new Date((_messages=messages[messages.length-1])===null||_messages===void 0?void 0:(_messages$timestamp=_messages.timestamp)===null||_messages$timestamp===void 0?void 0:_messages$timestamp.toDate()).toUTCString())),/*#__PURE__*/React.createElement(\"div\",{className:\"chat__headerRight\"},/*#__PURE__*/React.createElement(IconButton,null,/*#__PURE__*/React.createElement(SearchOutlined,null)),/*#__PURE__*/React.createElement(IconButton,null,/*#__PURE__*/React.createElement(AttachFile,null)),/*#__PURE__*/React.createElement(IconButton,null,/*#__PURE__*/React.createElement(MoreVert,null)))),/*#__PURE__*/React.createElement(\"div\",{className:\"chat__body\"},messages.map(function(message){var _message$timestamp;return/*#__PURE__*/React.createElement(\"p\",{className:\"chat__message \".concat(true&&'chat__reciever')},/*#__PURE__*/React.createElement(\"span\",{className:\"chat__name\"},message.name),message.message,/*#__PURE__*/React.createElement(\"span\",{className:\"chat__timestamp\"},new Date((_message$timestamp=message.timestamp)===null||_message$timestamp===void 0?void 0:_message$timestamp.toDate()).toUTCString()));})),/*#__PURE__*/React.createElement(\"div\",{className:\"chat__footer\"},/*#__PURE__*/React.createElement(InsertEmoticonIcon,null),/*#__PURE__*/React.createElement(\"form\",null,/*#__PURE__*/React.createElement(\"input\",{value:input,onChange:function onChange(e){return setInput(e.target.value);},placeholder:\"Type a message\",type:\"text\"}),/*#__PURE__*/React.createElement(Button,{onClick:sendMessage,type:\"submit\"},\"Send a message\")),/*#__PURE__*/React.createElement(IconButton,null,/*#__PURE__*/React.createElement(SendIcon,null)),/*#__PURE__*/React.createElement(IconButton,null,/*#__PURE__*/React.createElement(MicIcon,null))));}export default Chat;","map":{"version":3,"sources":["C:/Users/Admin/Desktop/WhatsApp/whatsapp-clone/src/Chat.js"],"names":["React","Avatar","IconButton","Button","useEffect","useState","SearchOutlined","AttachFile","MoreVert","InsertEmoticonIcon","MicIcon","SendIcon","useParams","db","useStateValue","firebase","Chat","input","setInput","seed","setSeed","roomId","roomName","setRoomName","messages","setMessages","user","dispatch","collection","doc","onSnapshot","snapshot","data","name","orderBy","docs","map","Math","floor","random","sendMessage","e","preventDefault","console","log","add","message","displayName","timestamp","firestore","FieldValue","serverTimestamp","Date","length","toDate","toUTCString","target","value"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport './Chat.css';\r\nimport { Avatar, IconButton, Button } from \"@material-ui/core\";\r\nimport { useEffect , useState } from \"react\";\r\nimport SearchOutlined from \"@material-ui/icons/SearchOutlined\";\r\nimport AttachFile from \"@material-ui/icons/AttachFile\";\r\nimport MoreVert from \"@material-ui/icons/MoreVert\";\r\nimport InsertEmoticonIcon from '@material-ui/icons/InsertEmoticon';\r\nimport MicIcon from '@material-ui/icons/Mic';\r\nimport SendIcon from '@material-ui/icons/Send';\r\nimport { useParams } from \"react-router-dom\";\r\nimport db from './firebase';\r\nimport { useStateValue } from './StateProvider';\r\nimport firebase from 'firebase';\r\n\r\n\r\nfunction Chat() {\r\n    const [input,setInput] =useState(\"\");\r\n    const [seed,setSeed] =useState(\"\");\r\n    const {roomId} = useParams();\r\n    const [roomName,setRoomName] = useState(\"\");\r\n    const [messages, setMessages] = useState([]);\r\n    const [{ user }, dispatch] = useStateValue();\r\n\r\n    useEffect(() => {\r\n        if(roomId) {\r\n            db.collection('rooms')\r\n            .doc(roomId)\r\n            .onSnapshot((snapshot) =>\r\n                setRoomName(snapshot.data().name));\r\n            \r\n            db.collection('rooms')\r\n            .doc(roomId)\r\n            .collection('messages')\r\n            .orderBy('timestamp',\"asc\")\r\n            .onSnapshot((snapshot) =>\r\n                    setMessages(snapshot.docs.map(doc => doc.data()))\r\n            );\r\n        }\r\n    }, [roomId])\r\n\r\n    useEffect(() => {\r\n        setSeed(Math.floor(Math.random()*5000));\r\n    }, [roomId]);\r\n\r\n    const sendMessage = (e) => {\r\n        e.preventDefault();\r\n        console.log(\"You Typed >>>>\",input);\r\n        db.collection('rooms')\r\n        .doc(roomId)\r\n        .collection(\"messages\")\r\n        .add({\r\n            message: input,\r\n            name: user.displayName,\r\n            timestamp: firebase.firestore.FieldValue.serverTimestamp(),\r\n        });\r\n        setInput(\"\");\r\n    };\r\n\r\n    return (\r\n        <div className=\"chat\">\r\n            <div className=\"chat__header\">\r\n                <Avatar  src={`https://avatars.dicebear.com/api/human/${seed}.svg`} />\r\n                <div className=\"chat__headerInfo\">\r\n                    <h3>{roomName}</h3>\r\n                    <p>\r\n                        last seen{\" \"}\r\n                        {\r\n                            new Date(\r\n                                messages[messages.length-1]?.timestamp?.toDate()\r\n                            ).toUTCString()\r\n                        }\r\n                    </p>\r\n                    \r\n                </div>\r\n                <div className=\"chat__headerRight\">\r\n                    <IconButton>\r\n                        <SearchOutlined />\r\n                    </IconButton>\r\n                    <IconButton>\r\n                        <AttachFile />\r\n                    </IconButton>\r\n                    <IconButton>\r\n                        <MoreVert />\r\n                    </IconButton>\r\n                </div>\r\n            </div>\r\n            <div className=\"chat__body\">\r\n                {messages.map(message => (\r\n                    <p className={`chat__message ${true && 'chat__reciever'}`}>\r\n                    <span className=\"chat__name\">\r\n                        {message.name}\r\n                    </span>\r\n                    {message.message}\r\n                    <span className=\"chat__timestamp\">\r\n                        {new Date(message.timestamp?.toDate())\r\n                        .toUTCString()}\r\n                    </span>\r\n                    </p>\r\n                ))\r\n                }\r\n            </div>\r\n            <div className=\"chat__footer\">\r\n                <InsertEmoticonIcon />\r\n                <form>\r\n                    <input value={input} onChange={(e) => setInput(e.target.value)} placeholder=\"Type a message\" type='text'/>\r\n                    <Button onClick={sendMessage}\r\n                    type=\"submit\">\r\n                        Send a message\r\n                    </Button>\r\n                </form>\r\n                <IconButton>\r\n                    <SendIcon />\r\n                </IconButton>\r\n                <IconButton>\r\n                    <MicIcon />\r\n                </IconButton>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Chat\r\n"]},"metadata":{},"sourceType":"module"}